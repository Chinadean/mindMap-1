<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
	<head>
		<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
		<title>test Composition</title>
		<!--	共用文件，不要修改	start	-->
		<link href="../css/qunit.css" rel="stylesheet" type="text/css" />
		<script type="text/javascript" src="../js/base.js"></script>
		<script type="text/javascript" src="../js/lib/tools/qunit.js"></script>
		<!--	共用文件，不要修改	end	-->
		<script type="text/javascript">
			/*global ok, console, k, kampfer, test, QUnit*/
			kampfer.require('mindMap.Composition');
		</script>
	</head>
	<body>
		<!--	共用文件，不要修改	start	-->
		<h1 id="qunit-header">QUnit for Composition</h1>
		<h2 id="qunit-banner"></h2>
		<div id="qunit-testrunner-toolbar"></div>
		<h2 id="qunit-userAgent"></h2>
		<ol id="qunit-tests"></ol>
		<div id="qunit-fixture">
			test markup, will be hidden
		</div>
		<!--	共用文件，不要修改	end	-->
		<script type="text/javascript">
			test('实例化Composition对象', function(){
				var obj = new kampfer.mindMap.Composition();
				ok(obj, '成功实例化Composition对象');
				ok(obj.constructor === kampfer.mindMap.Composition, 'constructor正确');
				ok(obj instanceof kampfer.mindMap.Composition, 'instanceof Composition : true');
				ok(obj instanceof kampfer.events.EventTarget, 'instanceof EventTarget : true');
				ok(obj instanceof kampfer.Class, 'instanceof Class : true');
				ok(('_parent' in obj) && !obj._parent, '_parent属性存在,但未初始化');
				ok(('_id' in obj) && !obj._id, '_id属性存在,但未初始化');
				ok(('_children' in obj) && !obj._children, '_children属性存在,但未初始化');
			});
			
			test('Composition.setParent', function(){
				var obj = new kampfer.mindMap.Composition();
				var p = {name:'parent'};
				var parent = new kampfer.mindMap.Composition(); 
				
				try{
					obj.setParent(obj);
				}catch(e) {
					ok(!obj._parent, '无法将composition对象的parent设为它自己');
				}
				
				try{
					obj.setParent(p);
				}catch(e) {
					ok(!obj._parent, 'composition对象的parent不能是非composition对象');
				}
				
				obj.setParent(parent);
				ok(obj._parent === parent, '可以通过setParent方法设置parent');
				ok(obj._parentEventTarget === parent, 'setParent方法会设置_parentEventTarget');
			});
			
			test('Composition.getParent', function(){
				var obj = new kampfer.mindMap.Composition();
				var p = new kampfer.mindMap.Composition();
				obj.setParent(p);
				ok(obj.getParent() === p, '可以通过getParent方法获得_parent');
			});
			
			test('Composition.addChlid', function(){
				var obj = new kampfer.mindMap.Composition();
				var c = new kampfer.mindMap.Composition();
				var o = {};
				
				try{
					obj.addChild(o);
				} catch(e) {
					ok(true, 'addChild方法只接受composition对象作为参数');
				}
				
				obj.addChild(c);
				
				ok(c._parent === obj, 'addChild设置child的_parent属性');
				
				function getId() {
					for(var id in obj._children) {
						return id;
					}
				}
				ok(obj._children[getId()] === c, 'addChild设置parent的_children属性');
				
			});
			
			test('Composition.getChild', function() {
				ok(true);
			});
			
			test('Composition.eachChild', function() {
				ok(true);
			});
			
			test('Composition.removeChlid', function() {
				ok(true);
			});
			
			//未测试有parent的情况
			test('Composition.setId', function(){
				var obj = new kampfer.mindMap.Composition();
				ok(!obj._id, '实例化Composition时未设置id');
				obj.setId('kampfer');
				ok(obj._id === 'kampfer', '可以通过setId方法设置id');
			});
			
			//会生成id
			test('Composition.getId', function(){
				var obj = new kampfer.mindMap.Composition();
				obj.setId('kampfer');
				ok(obj.getId() === 'kampfer', '可以通过getId方法获得id');
			});
			
			test('Composition.dispose', function() {
				ok(true);
			});
		</script>
	</body>
</html>
